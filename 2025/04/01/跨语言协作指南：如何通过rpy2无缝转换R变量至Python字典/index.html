<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>跨语言协作指南：如何通过rpy2无缝转换R变量至Python字典 | Yeureka</title><meta name="author" content="Yeureka"><meta name="copyright" content="Yeureka"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="背景需求在数据科学实践中，我们经常需要整合不同语言的优势资源。本文将聚焦一个典型场景：将R语言的计算成果迁移至Python环境进行后续处理或可视化。通过rpy2工具包，我们可以实现变量结构的完整保留与高效转换。 技术选型：rpy2核心优势工具定位rpy2是Python与R语言之间的双向桥梁，支持在Python环境中直接调用R函数库。其独特价值在于：  生态融合：集成CRAN超过18,000个R包">
<meta property="og:type" content="article">
<meta property="og:title" content="跨语言协作指南：如何通过rpy2无缝转换R变量至Python字典">
<meta property="og:url" content="https://yeureka.github.io/2025/04/01/%E8%B7%A8%E8%AF%AD%E8%A8%80%E5%8D%8F%E4%BD%9C%E6%8C%87%E5%8D%97%EF%BC%9A%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87rpy2%E6%97%A0%E7%BC%9D%E8%BD%AC%E6%8D%A2R%E5%8F%98%E9%87%8F%E8%87%B3Python%E5%AD%97%E5%85%B8/index.html">
<meta property="og:site_name" content="Yeureka">
<meta property="og:description" content="背景需求在数据科学实践中，我们经常需要整合不同语言的优势资源。本文将聚焦一个典型场景：将R语言的计算成果迁移至Python环境进行后续处理或可视化。通过rpy2工具包，我们可以实现变量结构的完整保留与高效转换。 技术选型：rpy2核心优势工具定位rpy2是Python与R语言之间的双向桥梁，支持在Python环境中直接调用R函数库。其独特价值在于：  生态融合：集成CRAN超过18,000个R包">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://youpai.yeureka.cn/picgo/202504011310943.jpeg">
<meta property="article:published_time" content="2025-04-01T01:00:00.000Z">
<meta property="article:modified_time" content="2025-04-01T05:37:20.652Z">
<meta property="article:author" content="Yeureka">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="R 语言">
<meta property="article:tag" content="rpy2">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://youpai.yeureka.cn/picgo/202504011310943.jpeg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "跨语言协作指南：如何通过rpy2无缝转换R变量至Python字典",
  "url": "https://yeureka.github.io/2025/04/01/%E8%B7%A8%E8%AF%AD%E8%A8%80%E5%8D%8F%E4%BD%9C%E6%8C%87%E5%8D%97%EF%BC%9A%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87rpy2%E6%97%A0%E7%BC%9D%E8%BD%AC%E6%8D%A2R%E5%8F%98%E9%87%8F%E8%87%B3Python%E5%AD%97%E5%85%B8/",
  "image": "https://youpai.yeureka.cn/picgo/202504011310943.jpeg",
  "datePublished": "2025-04-01T01:00:00.000Z",
  "dateModified": "2025-04-01T05:37:20.652Z",
  "author": [
    {
      "@type": "Person",
      "name": "Yeureka",
      "url": "https://yeureka.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://yeureka.github.io/2025/04/01/%E8%B7%A8%E8%AF%AD%E8%A8%80%E5%8D%8F%E4%BD%9C%E6%8C%87%E5%8D%97%EF%BC%9A%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87rpy2%E6%97%A0%E7%BC%9D%E8%BD%AC%E6%8D%A2R%E5%8F%98%E9%87%8F%E8%87%B3Python%E5%AD%97%E5%85%B8/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//www.clarity.ms"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7d089aced760295b2badc71b04db3290";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-QB2MZCC7XG"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-QB2MZCC7XG')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-QB2MZCC7XG', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "u7ukp8d8il");
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '跨语言协作指南：如何通过rpy2无缝转换R变量至Python字典',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/myimg/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">134</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://blog.yeureka.cn/"><i class="fa-fw fa fa-heart"></i><span> 主站</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://blog.yeureka.cn/index.php/%e7%95%99%e8%a8%80%e6%9d%bf/"><i class="fa-fw fas fa-comment-alt"></i><span> 留言</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(https://youpai.yeureka.cn/picgo/202504011310943.jpeg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Yeureka</span></a><a class="nav-page-title" href="/"><span class="site-name">跨语言协作指南：如何通过rpy2无缝转换R变量至Python字典</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://blog.yeureka.cn/"><i class="fa-fw fa fa-heart"></i><span> 主站</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://blog.yeureka.cn/index.php/%e7%95%99%e8%a8%80%e6%9d%bf/"><i class="fa-fw fas fa-comment-alt"></i><span> 留言</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">跨语言协作指南：如何通过rpy2无缝转换R变量至Python字典</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-01T01:00:00.000Z" title="发表于 2025-04-01 09:00:00">2025-04-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-01T05:37:20.652Z" title="更新于 2025-04-01 13:37:20">2025-04-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%99%E7%A8%8B/">教程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">1.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>6分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><img src="https://youpai.yeureka.cn/picgo/202504011310943.jpeg"></p>
<h2 id="背景需求"><a href="#背景需求" class="headerlink" title="背景需求"></a>背景需求</h2><p>在数据科学实践中，我们经常需要整合不同语言的优势资源。本文将聚焦一个典型场景：将R语言的计算成果迁移至Python环境进行后续处理或可视化。通过rpy2工具包，我们可以实现变量结构的完整保留与高效转换。</p>
<h2 id="技术选型：rpy2核心优势"><a href="#技术选型：rpy2核心优势" class="headerlink" title="技术选型：rpy2核心优势"></a>技术选型：rpy2核心优势</h2><h3 id="工具定位"><a href="#工具定位" class="headerlink" title="工具定位"></a>工具定位</h3><p>rpy2是Python与R语言之间的双向桥梁，支持在Python环境中直接调用R函数库。其独特价值在于：</p>
<ul>
<li><strong>生态融合</strong>：集成CRAN超过18,000个R包</li>
<li><strong>性能优化</strong>：采用内存共享机制减少数据拷贝开销</li>
<li><strong>开发效率</strong>：支持Jupyter Notebook实时交互<h3 id="核心功能矩阵"><a href="#核心功能矩阵" class="headerlink" title="核心功能矩阵"></a>核心功能矩阵</h3><table>
<thead>
<tr>
<th>功能维度</th>
<th>具体实现</th>
</tr>
</thead>
<tbody><tr>
<td>代码互操作</td>
<td>支持在Python中执行R代码块，调用ggplot2、dplyr等经典库</td>
</tr>
<tr>
<td>数据转换</td>
<td>自动处理numpy数组与R矩阵、pandas.DataFrame与data.frame的类型转换</td>
</tr>
<tr>
<td>可视化整合</td>
<td>在Jupyter中直接渲染R图形输出（支持ggplot2、lattice等可视化库）</td>
</tr>
<tr>
<td>扩展能力</td>
<td>提供C扩展接口，支持并行计算加速</td>
</tr>
</tbody></table>
<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 前置条件：已配置R语言环境（建议4.0+版本）</span></span><br><span class="line"><span class="comment"># 验证R_HOME环境变量</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$R_HOME</span></span><br><span class="line"><span class="comment"># 安装核心组件</span></span><br><span class="line">pip install rpy2 pandas</span><br></pre></td></tr></table></figure>
<h2 id="实现方案"><a href="#实现方案" class="headerlink" title="实现方案"></a>实现方案</h2><h3 id="数据持久化（R端）"><a href="#数据持久化（R端）" class="headerlink" title="数据持久化（R端）"></a>数据持久化（R端）</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 保存目标变量到二进制文件</span></span><br><span class="line">save<span class="punctuation">(</span>r_var<span class="punctuation">,</span> file<span class="operator">=</span><span class="string">&quot;r_var.RData&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="数据加载与转换（Python端）"><a href="#数据加载与转换（Python端）" class="headerlink" title="数据加载与转换（Python端）"></a>数据加载与转换（Python端）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">convert_r2py</span>(<span class="params">obj_name, sub_obj_name=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    递归解析R对象结构，实现自动化类型转换</span></span><br><span class="line"><span class="string">    Parameters:</span></span><br><span class="line"><span class="string">        obj_name (str): 目标R变量名称</span></span><br><span class="line"><span class="string">        sub_obj_name (str): 嵌套子对象名称（用于处理list结构）</span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        Python原生类型或pandas对象（保留完整元数据）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> sub_obj_name <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        _r_obj_name = <span class="string">f&quot;<span class="subst">&#123;obj_name&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        _r_obj_name = <span class="string">f&quot;<span class="subst">&#123;obj_name&#125;</span>$<span class="subst">&#123;sub_obj_name&#125;</span>&quot;</span></span><br><span class="line">    _r_obj = robjects.r(_r_obj_name)</span><br><span class="line">    <span class="comment"># 如果传入的是R列表，则遍历列表中的每一个子变量，返回子变量字典</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(_r_obj, ListVector):</span><br><span class="line">        <span class="keyword">return</span> &#123;_sub_obj_name: convert_r2py(_r_obj_name, _sub_obj_name) <span class="keyword">for</span> _sub_obj_name <span class="keyword">in</span> _r_obj.names&#125;</span><br><span class="line">    <span class="comment"># 如果传入的不是R列表，则解析此变量，并返回R对象对应的Python对象。</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(_r_obj, np.ndarray):  <span class="comment"># 如果值时array，则有一维和二维两种情况，两种情况获取行列变量名的方法不同</span></span><br><span class="line">        _r_obj_shape = _r_obj.shape</span><br><span class="line">        array_dim = <span class="built_in">len</span>(_r_obj_shape)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        array_dim = <span class="number">1</span></span><br><span class="line">    <span class="comment"># 根据变量的维度匹配获取行列变量名的方法</span></span><br><span class="line">    <span class="keyword">if</span> array_dim == <span class="number">2</span>:</span><br><span class="line">        _row_names = robjects.r(<span class="string">f&#x27;rownames(<span class="subst">&#123;_r_obj_name&#125;</span>)&#x27;</span>)</span><br><span class="line">        _col_names = robjects.r(<span class="string">f&#x27;colnames(<span class="subst">&#123;_r_obj_name&#125;</span>)&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> pd.DataFrame(_r_obj, index=_row_names, columns=_col_names)</span><br><span class="line">    <span class="keyword">elif</span> array_dim == <span class="number">1</span>:</span><br><span class="line">        _names = robjects.r(<span class="string">f&#x27;names(<span class="subst">&#123;_r_obj_name&#125;</span>)&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(_names, NULLType):</span><br><span class="line">            <span class="keyword">return</span> _r_obj</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> pd.Series(_r_obj, index=_names, name=obj_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_rdata</span>(<span class="params">file_path, obj_name=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    封装R数据文件加载过程</span></span><br><span class="line"><span class="string">    Parameters:</span></span><br><span class="line"><span class="string">        file_path (str): .RData文件路径</span></span><br><span class="line"><span class="string">        obj_name (str): 指定加载的变量名（可选）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 加载 .RData 文件</span></span><br><span class="line">    r_data_file_array = robjects.r[<span class="string">&#x27;load&#x27;</span>](file_path)</span><br><span class="line">    <span class="keyword">if</span> obj_name <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> &#123;obj_name.replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;_&quot;</span>) <span class="keyword">if</span> <span class="string">&quot;.&quot;</span> <span class="keyword">in</span> obj_name <span class="keyword">else</span> obj_name: convert_r2py(obj_name) <span class="keyword">for</span> obj_name <span class="keyword">in</span> r_data_file_array&#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> convert_r2py(obj_name)</span><br></pre></td></tr></table></figure>
<h3 id="执行示例"><a href="#执行示例" class="headerlink" title="执行示例"></a>执行示例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rpy2.robjects <span class="keyword">import</span> pandas2ri</span><br><span class="line">pandas2ri.activate()  <span class="comment"># 启用增强转换模式</span></span><br><span class="line">dataset = parse_rdata(<span class="string">&quot;r_var.RData&quot;</span>)  <span class="comment"># 获取结构化字典</span></span><br><span class="line"><span class="built_in">print</span>(dataset.keys())  <span class="comment"># 查看所有转换成功的变量</span></span><br></pre></td></tr></table></figure>
<h2 id="技术解析"><a href="#技术解析" class="headerlink" title="技术解析"></a>技术解析</h2><h3 id="关键实现逻辑"><a href="#关键实现逻辑" class="headerlink" title="关键实现逻辑"></a>关键实现逻辑</h3></li>
</ul>
<ol>
<li><strong>元数据捕获</strong><br>通过R原生函数<code>rownames()</code>/<code>colnames()</code>获取维度标签，确保pandas对象与原始数据结构完全对齐</li>
<li><strong>递归策略</strong><br>对ListVector类型采用深度优先遍历，自动处理嵌套数据结构</li>
<li><strong>异常处理</strong><br>内置NULLType检测，避免因缺失元数据导致的转换失败<h2 id="性能建议"><a href="#性能建议" class="headerlink" title="性能建议"></a>性能建议</h2></li>
<li>对于超过1GB的大型数据集，建议直接使用共享内存交换：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rpy2.robjects <span class="keyword">import</span> globalenv</span><br><span class="line">globalenv[<span class="string">&#x27;big_matrix&#x27;</span>] = np.random.rand(<span class="number">10000</span>,<span class="number">10000</span>)  <span class="comment"># 免拷贝传递</span></span><br></pre></td></tr></table></figure></li>
<li>启用多线程加速：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rpy2 <span class="keyword">import</span> rinterface</span><br><span class="line">rinterface.initr(rthreads=<span class="number">4</span>)  <span class="comment"># 设置R运行时线程数</span></span><br></pre></td></tr></table></figure>
<h2 id="代码要点解析"><a href="#代码要点解析" class="headerlink" title="代码要点解析"></a>代码要点解析</h2>通过 <code>robjects.r()</code> 这个核心函数，可以实现运行 R 代码并将结果返回到 Python 环境中，此脚本基于此特性构建。以下是部分过程的解析，仅为帮助理解，可能无法正确运行。<h3 id="读取-R-文件"><a href="#读取-R-文件" class="headerlink" title="读取 R 文件"></a>读取 R 文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rpy2.robjects <span class="keyword">as</span> robjects</span><br><span class="line"><span class="keyword">from</span> rpy2.robjects <span class="keyword">import</span> pandas2ri</span><br><span class="line"><span class="comment"># 激活pandas与R对象之间的转换</span></span><br><span class="line">pandas2ri.activate()</span><br><span class="line"><span class="comment"># 通过robjects.r()可以运行 R 语言的代码，并且返回值自动转换为 Python 数据类型</span></span><br><span class="line"><span class="comment"># 读取 R 变量到环境中</span></span><br><span class="line">r_data_file_array = robjects.r[<span class="string">&#x27;load&#x27;</span>](<span class="string">&quot;r_var.RData&quot;</span>) </span><br></pre></td></tr></table></figure>
<code>r_data_file_array</code> 是一个可迭代对象，可以使用<code>for obj_name in r_data_file_array</code>获取这个 R 文件下保存的所有变量名。<br>经过以上步骤，R 文件中保存的所有变量已经读取 Python 中，此时可以读取需要的变量。<h3 id="读取变量并转换为-Python-的变量类型"><a href="#读取变量并转换为-Python-的变量类型" class="headerlink" title="读取变量并转换为 Python 的变量类型"></a>读取变量并转换为 Python 的变量类型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r_obj = robjects.r(obj_name)</span><br></pre></td></tr></table></figure>
此时的 <code>r_obj</code> 已经是 Python 支持的变量类型了，但是丢失了行名和列名<h3 id="将变量转换为-pandas-的-DataFrame、Series-格式，并恢复行列名"><a href="#将变量转换为-pandas-的-DataFrame、Series-格式，并恢复行列名" class="headerlink" title="将变量转换为 pandas 的 DataFrame、Series 格式，并恢复行列名"></a>将变量转换为 pandas 的 DataFrame、Series 格式，并恢复行列名</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先判断获取到的 r_obj 是不是已经是最终数据</span></span><br><span class="line"><span class="comment"># 如果值不是ndarray，则变量是 R 语言的 list，采用递归的方法继续向下解析，具体参照以上完整代码</span></span><br><span class="line"><span class="keyword">from</span> rpy2.robjects.vectors <span class="keyword">import</span> ListVector</span><br><span class="line"><span class="keyword">from</span> rpy2.rinterface_lib.sexp <span class="keyword">import</span> NULLType</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">isinstance</span>(r_obj, ListVector):</span><br><span class="line">    <span class="keyword">return</span> 递归解析</span><br><span class="line"><span class="comment"># 在递归的过程中，我们需要继续使用 robjects.r() 读取 r_obj 内的变量，可以使用 r_obj.names 获取 r_obj 内部的变量名，采用 robjects.r(f&quot;&#123;obj_name&#125;$&#123;sub_obj_name&#125;&quot;) 来读取内部变量。这部分逻辑是为了能够通过递归自动解析并转换为字典，各位参照完整代码即可。</span></span><br><span class="line"><span class="comment"># 如果值是ndarray，说明已经获取到了最终变量</span></span><br><span class="line"><span class="comment"># 此时有一维和二维两种情况，两种情况获取行列变量名的方法不同，先获取变量维度</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">isinstance</span>(r_obj, np.ndarray):  </span><br><span class="line">    r_obj_shape = r_obj.shape</span><br><span class="line">    array_dim = <span class="built_in">len</span>(r_obj_shape)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    array_dim = <span class="number">1</span></span><br><span class="line"><span class="comment"># 根据变量的维度匹配获取行列变量名的方法</span></span><br><span class="line"><span class="comment"># 如果是二维变量则转换为 DataFrame</span></span><br><span class="line"><span class="keyword">if</span> array_dim == <span class="number">2</span>:</span><br><span class="line">    row_names = robjects.r(<span class="string">f&#x27;rownames(<span class="subst">&#123;obj_name&#125;</span>)&#x27;</span>)</span><br><span class="line">    col_names = robjects.r(<span class="string">f&#x27;colnames(<span class="subst">&#123;obj_name&#125;</span>)&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(pd.DataFrame(r_obj, index=row_names, columns=col_names))</span><br><span class="line"><span class="comment"># 如果是一维变量有两种情况，如果变量有names，则转换成Series，如果没有直接返回这个变量</span></span><br><span class="line"><span class="keyword">elif</span> array_dim == <span class="number">1</span>:</span><br><span class="line">    names = robjects.r(<span class="string">f&#x27;names(<span class="subst">&#123;obj_name&#125;</span>)&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(names, NULLType):</span><br><span class="line">        <span class="built_in">print</span>(r_obj)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(pd.Series(_r_obj, index=names, name=obj_name))</span><br></pre></td></tr></table></figure>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2>通过本文方案，开发者可以突破语言边界，灵活调度R的统计计算能力与Python的工程化优势。这种跨语言协作模式特别适用于以下场景：</li>
</ol>
<ul>
<li>需要复用现有R模型产出的团队</li>
<li>在Python Web服务中集成R算法</li>
<li>构建混合语言的数据分析流水线<br>欢迎在评论区分享您的集成实践与优化建议！</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://yeureka.github.io">Yeureka</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://yeureka.github.io/2025/04/01/%E8%B7%A8%E8%AF%AD%E8%A8%80%E5%8D%8F%E4%BD%9C%E6%8C%87%E5%8D%97%EF%BC%9A%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87rpy2%E6%97%A0%E7%BC%9D%E8%BD%AC%E6%8D%A2R%E5%8F%98%E9%87%8F%E8%87%B3Python%E5%AD%97%E5%85%B8/">https://yeureka.github.io/2025/04/01/跨语言协作指南：如何通过rpy2无缝转换R变量至Python字典/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://yeureka.github.io" target="_blank">Yeureka</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/R-%E8%AF%AD%E8%A8%80/">R 语言</a><a class="post-meta__tags" href="/tags/rpy2/">rpy2</a></div><div class="post-share"><div class="social-share" data-image="https://youpai.yeureka.cn/picgo/202504011310943.jpeg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/04/03/%E6%89%93%E9%80%A0%E5%AD%A6%E6%9C%AF%E5%A4%96%E6%8C%82%E5%A4%A7%E8%84%91%EF%BC%9AZotero+Logseq%E8%81%94%E5%8A%A8%E6%9E%84%E5%BB%BA%E8%AE%BA%E6%96%87%E5%BA%93/" title="打造学术外挂大脑：Zotero+Logseq联动构建论文库"><img class="cover" src="https://youpai.yeureka.cn/picgo/202504032015748.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">打造学术外挂大脑：Zotero+Logseq联动构建论文库</div></div><div class="info-2"><div class="info-item-1"> “你是否经历过这样的场景： 电脑里塞满了从各个数据库下载的 PDF 文献，文件夹命名混乱到连自己都找不到；读论文时灵感迸发写下的笔记，却散落在 Zotero 注释、Word 文档和纸质笔记本之间；写论文需要引用某个关键结论时，不得不花半小时翻查’可能存放在某个地方’的笔记。 在科研领域，我们缺的从来不是知识获取渠道，而是让碎片化信息真正流动起来的系统。直到我发现 Zotero 与 Logseq 的联动组合——前者像严谨的图书馆管理员，后者则化身思维导图师，共同构建起一个自生长的学术知识库。 尽管 Logseq 内置支持 Zotero 文献关联，但存在两个关键瓶颈：笔记同步割裂：Zotero 中的笔记修改后无法自动同步到 Logseq，需反复手动导入。格式兼容障碍：导出的笔记以纯文本块形式存在，无法继承 Markdown 语法特性，导致双向链接失效 本文方案通过 Zotero Better Notes 插件 能够实现：✅ 保留 Markdown 原生语法（标签、双向链接）✅ 建立 Zotero→Logseq 的单向自动同步通道✅ 兼容 Logseq 日期日志关联机制 所需工具 Z...</div></div></div></a><a class="pagination-related" href="/2024/08/12/%E8%A7%A3%E5%86%B3%E6%AF%8F%E6%AC%A1%20unraid%20%E9%87%8D%E5%90%AF%E4%BB%A5%E5%90%8E%20immich%20%E8%B4%A6%E6%88%B7%E4%B8%A2%E5%A4%B1%E9%97%AE%E9%A2%98/" title="解决每次 unraid 重启以后 immich 账户丢失问题"><img class="cover" src="https://youpai.yeureka.cn/picgo/202408122015206.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">解决每次 unraid 重启以后 immich 账户丢失问题</div></div><div class="info-2"><div class="info-item-1"> 最近购入了一台天钡 Wtr pro amd 版，安装 unraid 后部署了最新版 immich，但是发现每次重启 unraid 后 immich 的账户都会丢失。经排查发现是 env 文件中 DB_DATA_LOCATION 设置错误导致的。 错误设置为： 1234# The location where your uploaded files are storedUPLOAD_LOCATION=/mnt/user/immich# The location where your database files are storedDB_DATA_LOCATION=/volumn1/... 正确设置为 1234# The location where your uploaded files are storedUPLOAD_LOCATION=/mnt/user/immich# The location where your database files are storedDB_DATA_LOCATION=/mnt/user/appdata/immich/postgres 由于 ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2017/03/25/01-%E5%A4%8D%E6%9D%82%E5%BA%A61%20%E6%9C%80%E5%A4%A7%E5%AD%90%E5%88%97%E5%92%8C%E9%97%AE%E9%A2%98/" title="01-复杂度1 最大子列和问题"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-03-25</div><div class="info-item-2">01-复杂度1 最大子列和问题</div></div><div class="info-2"><div class="info-item-1">给定KK个整数组成的序列 {N1, N2,…, Nk}，“连续子列”被定义 {Ni, N(i+1),…, Nj}，其中 1 ≤ i ≤ j ≤ K。“最大子列和”则被定义为所有连续子列元素的和中最大者。例如给定序列{ -2, 11, -4, 13, -5, -2 }，其连续子列{ 11, -4, 13 }有最大的和20。现要求你编写程序，计算给定整数序列的最大子列和。 本题旨在测试各种不同的算法在各种数据情况下的表现。各组测试数据特点如下： 数据1：与样例等价，测试基本正确性； 数据2：102个随机整数； 数据3：103个随机整数； 数据4：104个随机整数； 数据5：105个随机整数；  输入格式输入第1行给出正整数KK (\le 100000≤100000)；第2行给出KK个整数，其间以空格分隔。 输出格式在一行中输出最大子列和。如果序列中所有整数皆为负数，则输出0。 输入样例6-2 11 -4 13 -5 -2 输出样例20 代码实现PythonO(n^2)123456789101112131415161718192021def MaxSubSequenceSum(lst,...</div></div></div></a><a class="pagination-related" href="/2017/03/25/01-%E5%A4%8D%E6%9D%82%E5%BA%A62%20Maximum%20Subsequence%20Sum/" title="01-复杂度2 Maximum Subsequence Sum"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-03-25</div><div class="info-item-2">01-复杂度2 Maximum Subsequence Sum</div></div><div class="info-2"><div class="info-item-1">Given a sequence of KK integers {N1, N2,…, Nk}. A continuous subsequence is defined to be {Ni, N(i+1),…, Nj} where 1 ≤ i ≤ j ≤ K. The Maximum Subsequence is the continuous subsequence which has the largest sum of its elements. For example, given sequence { -2, 11, -4, 13, -5, -2 }, its maximum subsequence is { 11, -4, 13 } with the largest sum being 20.   Now you are supposed to find the largest sum, together with the first and the last numbers of the maximum subsequence. Input SpecificationE...</div></div></div></a><a class="pagination-related" href="/2017/08/05/Django%20Markdown%E5%92%8C%E4%BB%A3%E7%A0%81%E9%AB%98%E4%BA%AE/" title="Django Markdown和代码高亮"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-08-05</div><div class="info-item-2">Django Markdown和代码高亮</div></div><div class="info-2"><div class="info-item-1">Django Markdown和代码高亮 Markdown 你的博文markdown越来越流行, 越来越多的写博客的博主都喜欢上了makrdown这种标记性语言的易用性和美观性. 像简书, 作业部落, Mou都是比较出名的markdown在线或者离线形式 现在我们就来markdown自己的博客, 首先是安装markdown库, 使用下面命令 12#首先是安装markdown$ sudo pip install markdown  #记得激活虚拟环境 现在说说怎么markdown你的博文, 在article下建立新文件夹templatetags,然后我们来定义的自己的 template filter, 然后在templatetags中建立init.py, 让文件夹可以被看做一个包, 然后在文件夹中新建custom_markdown.py文件, 添加代码 1234567891011121314151617import markdownfrom django import templatefrom django.template.defaultfilters import string...</div></div></div></a><a class="pagination-related" href="/2017/08/04/Django%20Models%E5%92%8CAdmin%E4%BB%A5%E5%8F%8AViews%E5%92%8CURL/" title="Django Models和Admin以及Views和URL"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-08-04</div><div class="info-item-2">Django Models和Admin以及Views和URL</div></div><div class="info-2"><div class="info-item-1">Django Models和Admin以及Views和URL Django Shell现在我们进入Django中的交互式shell来进行数据库的增删改查等操作 123456$ python manage.py shellPython 3.4.2 (v3.4.2:ab2c023a9432, Oct  5 2014, 20:42:22)[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwinType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.(InteractiveConsole)&gt;&gt;&gt; 这里进入Django的shell和python内置的shell是非常类似的 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525...</div></div></div></a><a class="pagination-related" href="/2017/07/17/Django%20%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" title="Django Hello World"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-07-17</div><div class="info-item-2">Django Hello World</div></div><div class="info-2"><div class="info-item-1">Django Hello World Django 的特点Django 是由 Python 开发的一个免费的开源网站框架，可以用于快速搭建高性能，优雅的网站！何为优雅，请看 Django 的以下特点： 强大的数据库功能用 Python 的类继承，几行代码就可以拥有一个丰富、动态的数据库操作接口（API），如果需要你也能执行 SQL 语句进行数据库的增、删、查、改操作。 自带的强大后台功能几行简单的代码就能让你的网站拥有一个强大的后台，轻松管理你的内容！ 优雅的链接路由用正则匹配方式匹配链接，传递到对应的函数，随意定义，如你所愿。 Model(模板)系统易于扩展的 Model 系统，设计简易。易于代码解耦。 缓存系统与 memcached 或其他的缓存系统联用，更出色的表现，更快的加载速度。 国际化支持多语言英语，允许自定义翻译的字符，轻松翻译成多国语言。 Hello World 关于 Django 的环境搭建我们将在下一节中详细介绍，下面部分为初学 Django 的初体验，让读者感受 Django 搭建 Web 服务端的快捷。  在用户根目录下，新建一个 django 目录，用于...</div></div></div></a><a class="pagination-related" href="/2017/08/05/Django%20Template%E5%92%8C%E5%8A%A8%E6%80%81URL/" title="Django Template和动态URL"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2017-08-05</div><div class="info-item-2">Django Template和动态URL</div></div><div class="info-2"><div class="info-item-1">Django Template和动态URL TemplateTemplate初探到目前为止我们只是简单的将后端数据显示到页面上, 没有涉及到HTML代码, 而优雅的网站总算通过CSS+HTML, 甚至还有强大的JS的支持. 在这个教程中要打造一个Blog, 所以我们设置一个Blog界面, 原本打算使用Bootstrap作为前段的工具, 不过经过@游逸的建议, 使用了更加轻量级的Pure, 同样是响应式页面设置, 这也将是未来的主流吧.. 在my_blog下添加文件名, 文件夹名为templates 12345678910111213141516171819202122232425262728293031323334$ mkdir templates#看到当前文件构成my_blog├── article│   ├── __init__.py│   ├── __pycache__│   │   ├── __init__.cpython-34.pyc│   │   ├── admin.cpython-34.pyc│   │   ├── models.cpython-34.pyc│   ...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/myimg/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Yeureka</div><div class="author-info-description">心如止水行如风</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">134</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/yeureka" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF%E9%9C%80%E6%B1%82"><span class="toc-number">1.</span> <span class="toc-text">背景需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%EF%BC%9Arpy2%E6%A0%B8%E5%BF%83%E4%BC%98%E5%8A%BF"><span class="toc-number">2.</span> <span class="toc-text">技术选型：rpy2核心优势</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E5%AE%9A%E4%BD%8D"><span class="toc-number">2.1.</span> <span class="toc-text">工具定位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E7%9F%A9%E9%98%B5"><span class="toc-number">2.2.</span> <span class="toc-text">核心功能矩阵</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">3.</span> <span class="toc-text">环境准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88"><span class="toc-number">4.</span> <span class="toc-text">实现方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96%EF%BC%88R%E7%AB%AF%EF%BC%89"><span class="toc-number">4.1.</span> <span class="toc-text">数据持久化（R端）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E4%B8%8E%E8%BD%AC%E6%8D%A2%EF%BC%88Python%E7%AB%AF%EF%BC%89"><span class="toc-number">4.2.</span> <span class="toc-text">数据加载与转换（Python端）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.3.</span> <span class="toc-text">执行示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90"><span class="toc-number">5.</span> <span class="toc-text">技术解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%AE%9E%E7%8E%B0%E9%80%BB%E8%BE%91"><span class="toc-number">5.1.</span> <span class="toc-text">关键实现逻辑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E5%BB%BA%E8%AE%AE"><span class="toc-number">6.</span> <span class="toc-text">性能建议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%A6%81%E7%82%B9%E8%A7%A3%E6%9E%90"><span class="toc-number">7.</span> <span class="toc-text">代码要点解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96-R-%E6%96%87%E4%BB%B6"><span class="toc-number">7.1.</span> <span class="toc-text">读取 R 文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E5%8F%98%E9%87%8F%E5%B9%B6%E8%BD%AC%E6%8D%A2%E4%B8%BA-Python-%E7%9A%84%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B"><span class="toc-number">7.2.</span> <span class="toc-text">读取变量并转换为 Python 的变量类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%8F%98%E9%87%8F%E8%BD%AC%E6%8D%A2%E4%B8%BA-pandas-%E7%9A%84-DataFrame%E3%80%81Series-%E6%A0%BC%E5%BC%8F%EF%BC%8C%E5%B9%B6%E6%81%A2%E5%A4%8D%E8%A1%8C%E5%88%97%E5%90%8D"><span class="toc-number">7.3.</span> <span class="toc-text">将变量转换为 pandas 的 DataFrame、Series 格式，并恢复行列名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-number">8.</span> <span class="toc-text">结语</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/11/18/%E8%A7%A3%E9%94%81%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE%EF%BC%9A%E5%9C%A8%20Unraid%20%E4%B8%8A%E9%83%A8%E7%BD%B2%20Seafile%20%E5%B9%B6%E9%85%8D%E7%BD%AE%20Frp%20%E6%8C%87%E5%8D%97/" title="解锁外网访问：在 Unraid 上部署 Seafile 并配置 Frp 指南"><img src="https://youpai.yeureka.cn/picgo/20251118110537438.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="解锁外网访问：在 Unraid 上部署 Seafile 并配置 Frp 指南"/></a><div class="content"><a class="title" href="/2025/11/18/%E8%A7%A3%E9%94%81%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE%EF%BC%9A%E5%9C%A8%20Unraid%20%E4%B8%8A%E9%83%A8%E7%BD%B2%20Seafile%20%E5%B9%B6%E9%85%8D%E7%BD%AE%20Frp%20%E6%8C%87%E5%8D%97/" title="解锁外网访问：在 Unraid 上部署 Seafile 并配置 Frp 指南">解锁外网访问：在 Unraid 上部署 Seafile 并配置 Frp 指南</a><time datetime="2025-11-18T04:00:00.000Z" title="发表于 2025-11-18 12:00:00">2025-11-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/05/%E6%89%93%E9%80%A0%E5%AD%A6%E6%9C%AF%E5%A4%96%E6%8C%82%E5%A4%A7%E8%84%91%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AQuery%E8%AF%AD%E6%B3%95%E6%89%93%E9%80%A0%E6%99%BA%E8%83%BD%E6%96%87%E7%8C%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F/" title="打造学术外挂大脑（三）：Query语法打造智能文献检索系统"><img src="https://youpai.yeureka.cn/picgo/202504052302915.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="打造学术外挂大脑（三）：Query语法打造智能文献检索系统"/></a><div class="content"><a class="title" href="/2025/04/05/%E6%89%93%E9%80%A0%E5%AD%A6%E6%9C%AF%E5%A4%96%E6%8C%82%E5%A4%A7%E8%84%91%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AQuery%E8%AF%AD%E6%B3%95%E6%89%93%E9%80%A0%E6%99%BA%E8%83%BD%E6%96%87%E7%8C%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F/" title="打造学术外挂大脑（三）：Query语法打造智能文献检索系统">打造学术外挂大脑（三）：Query语法打造智能文献检索系统</a><time datetime="2025-04-05T13:30:00.000Z" title="发表于 2025-04-05 21:30:00">2025-04-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/04/%E6%89%93%E9%80%A0%E5%AD%A6%E6%9C%AF%E5%A4%96%E6%8C%82%E5%A4%A7%E8%84%91%EF%BC%9AZotero+Logseq%E6%96%87%E7%8C%AE%E7%AC%94%E8%AE%B0%E6%A8%A1%E7%89%88%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97/" title="打造学术外挂大脑：Zotero+Logseq文献笔记模版进阶指南"><img src="https://youpai.yeureka.cn/picgo/202504042228945.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="打造学术外挂大脑：Zotero+Logseq文献笔记模版进阶指南"/></a><div class="content"><a class="title" href="/2025/04/04/%E6%89%93%E9%80%A0%E5%AD%A6%E6%9C%AF%E5%A4%96%E6%8C%82%E5%A4%A7%E8%84%91%EF%BC%9AZotero+Logseq%E6%96%87%E7%8C%AE%E7%AC%94%E8%AE%B0%E6%A8%A1%E7%89%88%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97/" title="打造学术外挂大脑：Zotero+Logseq文献笔记模版进阶指南">打造学术外挂大脑：Zotero+Logseq文献笔记模版进阶指南</a><time datetime="2025-04-04T13:30:00.000Z" title="发表于 2025-04-04 21:30:00">2025-04-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/03/%E6%89%93%E9%80%A0%E5%AD%A6%E6%9C%AF%E5%A4%96%E6%8C%82%E5%A4%A7%E8%84%91%EF%BC%9AZotero+Logseq%E8%81%94%E5%8A%A8%E6%9E%84%E5%BB%BA%E8%AE%BA%E6%96%87%E5%BA%93/" title="打造学术外挂大脑：Zotero+Logseq联动构建论文库"><img src="https://youpai.yeureka.cn/picgo/202504032015748.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="打造学术外挂大脑：Zotero+Logseq联动构建论文库"/></a><div class="content"><a class="title" href="/2025/04/03/%E6%89%93%E9%80%A0%E5%AD%A6%E6%9C%AF%E5%A4%96%E6%8C%82%E5%A4%A7%E8%84%91%EF%BC%9AZotero+Logseq%E8%81%94%E5%8A%A8%E6%9E%84%E5%BB%BA%E8%AE%BA%E6%96%87%E5%BA%93/" title="打造学术外挂大脑：Zotero+Logseq联动构建论文库">打造学术外挂大脑：Zotero+Logseq联动构建论文库</a><time datetime="2025-04-03T03:00:00.000Z" title="发表于 2025-04-03 11:00:00">2025-04-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/01/%E8%B7%A8%E8%AF%AD%E8%A8%80%E5%8D%8F%E4%BD%9C%E6%8C%87%E5%8D%97%EF%BC%9A%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87rpy2%E6%97%A0%E7%BC%9D%E8%BD%AC%E6%8D%A2R%E5%8F%98%E9%87%8F%E8%87%B3Python%E5%AD%97%E5%85%B8/" title="跨语言协作指南：如何通过rpy2无缝转换R变量至Python字典"><img src="https://youpai.yeureka.cn/picgo/202504011310943.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="跨语言协作指南：如何通过rpy2无缝转换R变量至Python字典"/></a><div class="content"><a class="title" href="/2025/04/01/%E8%B7%A8%E8%AF%AD%E8%A8%80%E5%8D%8F%E4%BD%9C%E6%8C%87%E5%8D%97%EF%BC%9A%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87rpy2%E6%97%A0%E7%BC%9D%E8%BD%AC%E6%8D%A2R%E5%8F%98%E9%87%8F%E8%87%B3Python%E5%AD%97%E5%85%B8/" title="跨语言协作指南：如何通过rpy2无缝转换R变量至Python字典">跨语言协作指南：如何通过rpy2无缝转换R变量至Python字典</a><time datetime="2025-04-01T01:00:00.000Z" title="发表于 2025-04-01 09:00:00">2025-04-01</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2017 - 2025 By Yeureka</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><span>备案号：沪ICP备18020215号-3</span></a><br><a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"><span>本网站由 <img class="cloudserver-icon" src="https://youpai.yeureka.cn/picgo/20251115182146855.png" height="26"> 提供CDN加速/云存储服务</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  const initGitalk = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyGitalk = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const gitalk = new Gitalk({
      clientID: 'Ov23liyzkd7T4eE66UGD',
      clientSecret: 'e25c2a47ef2ef0b2f8dfff8616838fac0fe35883',
      repo: 'BlogComment',
      owner: 'yeureka',
      admin: ['yeureka'],
      updateCountCallback: commentCount,
      ...option,
      id: isShuoshuo ? path : (option && option.id) || '3ca6ec2848b8428bae43eed076867061'
    })

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async(el, path) => {
    if (typeof Gitalk === 'function') initGitalk(el, path)
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.js')
      initGitalk(el, path)
    }
  }

  if (isShuoshuo) {
    'Gitalk' === 'Gitalk'
      ? window.shuoshuoComment = { loadComment: loadGitalk }
      : window.loadOtherComment = loadGitalk
    return
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><script async data-pjax src="https://cdn.bootcdn.net/ajax/libs/busuanzi/2.3.0/bsz.pure.mini.min.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>